<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

  <link rel="canonical" href="https://code-maven.com/jenkins-pipeline-running-external-programs" />

  <link rel="prev" href="jenkins-pipeline-hello-world.html">
  <link rel="next" href="jenkins-send-email-notifications.html">

  <link href="/atom" rel="alternate" type="application/atom+xml" title ="Code Maven" />

  <script>
    var user_info = {"logged_in":0};
  </script>

  <!-- Google recommended indication of translated versions -->
  


  <title>Jenkins Pipeline: running external programs with sh or bat</title>
  <meta name="description" content="">
  <meta name="author" content="szabgab">

  <!-- The Open Graph protocol -->
  <meta property="og:title" content="Jenkins Pipeline: running external programs with sh or bat"/>
  <meta property="og:type" content="article"/>
  
      <meta property="og:image" content="img/code_maven_128.png"/>
  
  <meta property="og:site_name" content="Code Maven"/>
  <meta property="og:description" content=""/>
  

  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" rel="stylesheet">


  <link href="css/style.css" rel="stylesheet">
  
  <link href="stati css/site.css" rel="stylesheet">

  <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>


  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="javascripts/perlmaven.js?20210507.1"></script>
  <script src="js/maven.js"></script>

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@szabgab" />
  <meta name="twitter:creator" content="@szabgab" />
  <meta name="twitter:title" content="Jenkins Pipeline: running external programs with sh or bat" />
  <meta name="twitter:description" content="" />
  
     <meta name="twitter:image" content="img/code_maven_128.png" />
  
</head>
<body>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <nav class="navbar navbar-default navbar-fixed-top navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Code Maven</a>
    </div>


    <div class="collapse navbar-collapse" id="navbar">
      
        <ul class="nav navbar-nav   ">
          
            

<!--
            
              
                <li><a href="/pm/login">Login</a></li>
                <li><a href="/pm/register">Register</a></li>
              
            
-->

            

            
                        <li><a href="/exercises">Exercises</a></li>
            

<!--
            
-->

            

            
                        <li><a href="/slides">Slides</a></li>
            

<!--
            
-->

            

            
                        <li><a href="/courses">Courses</a></li>
            

<!--
            
-->

            

            
                        <li><a href="/services">Services</a></li>
            

<!--
            
-->

            

            
          
        </ul>
      
        <ul class="nav navbar-nav navbar-right  ">
                        <li><a href="/keywords">Type keyword:</a></li>
            

<!--
            
-->

            

            
          
            

<!--
            
-->

            
              <li><form id="search_form">
                     <input id="search_box" type="text" data-provide="typeahead" data-items="4" aria-label="Enter your search term">
                  </form>
              </li>
            

            
                        <li><a href="/archive">Archive</a></li>
            

<!--
            
-->

            

            
                        <li><a href="/about">About</a></li>
            

<!--
            
-->

            

            
          
            

<!--
            
-->

            

            
              <li><a href="/atom" rel="alternate" type="application/atom+xml"><img src="img/feed-icon16x16.png" id="atom-icon" alt="Atom feed" /></a></li>
            
          
        </ul>
      
    </div>
  </div>
</nav>


    </div>
  </div>

  <div class="row">
    <div class="col-md-2" id="left-column">

            
         
      


      
<div id="series">
  <a href="jenkins.html">Jenkins</a>
  
  <hr>
  <ol>
  
    <li>Installations
      <ol>
        
          <li>
            <a  href="install-jenkins-on-ubuntu.html">Install Jenkins on Ubuntu</a>
            
          </li>
        
          <li>
            <a  href="vagrant-for-jenkins-on-ubuntu.html">Vagrant for Jenkins on Ubuntu</a>
            
          </li>
        
          <li>
            <a  href="jenkins-in-docker.html">Running Jenkins in Docker</a>
            
          </li>
        
      </ol>
    </li>
  
    <li>Examples
      <ol>
        
          <li>
            <a  href="jenkins-pipeline-hello-world.html">Jenkins Pipeline - Hello World</a>
            
          </li>
        
          <li>
            <a class="current" href="jenkins-pipeline-running-external-programs.html">Jenkins Pipeline: running external programs with sh or bat</a>
            <span class="glyphicon glyphicon-ok"></span>
          </li>
        
          <li>
            <a  href="jenkins-send-email-notifications.html">Jenkins Pipeline: Send e-mail notifications</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-short-text.html">Jenkins Pipeline: Add some text to the job using manager.addShortText</a>
            
          </li>
        
          <li>
            <a  href="jenkins-cli-create-node.html">Jenkins CLI: create node</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-builduser.html">Jenkins Pipeline BuildUser plugin</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-environment-variables.html">Jenkins Pipeline - set and use environment variables</a>
            
          </li>
        
          <li>
            <a  href="jenkins-git-check-out-using-reference.html">Jenkins Pipeline: git checkout using reference to speed up cloning large repositories</a>
            
          </li>
        
          <li>
            <a  href="jenkins-report-failed-stage-name.html">Jenkins report the name of the stage that failed</a>
            
          </li>
        
          <li>
            <a  href="jenkins-triggers.html">Jenkins triggers: Periodic polling</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-set-job-name-and-description.html">How to set the job number and description for a Jenkinsfile in a Jenkins Pipeline?</a>
            
          </li>
        
          <li>
            <a  href="jenkins-readfile-writefile.html">Jenkins Pipeline: read a file and write a file - readFile, writeFile</a>
            
          </li>
        
          <li>
            <a  href="jenkins-separate-jobs-for-development-and-production.html">Jenkins: separate jobs for development and production</a>
            
          </li>
        
          <li>
            <a  href="jenkins-get-current-user.html">Jenkins pipeline: get current user</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-parameters.html">Jenkins Pipeline parameters</a>
            
          </li>
        
          <li>
            <a  href="jenkins-arbitrary-code-execution.html">Jenkins pipelines: Arbitrary code execution in the shell</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-parallel-stages.html">Jenkins pipeline: parallel stages</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-collect-exit-code-from-external-commands.html">Jenkins Pipeline: Collect exit code from external commands</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-get-previous-build-status.html">Jenkins pipeline: Get previous build status - getPreviousBuild</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-interactive-input-during-process.html">Jenkins pipeline: interactive input during process</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-list-agents-by-name-or-by-label.html">Jenkins pipeline: List agents by name or by label</a>
            
          </li>
        
          <li>
            <a  href="jenkins-pipeline-add-badges.html">Jenkins pipeline: add badges</a>
            
          </li>
        
      </ol>
    </li>
  
  </ol>
</div>



    </div>
    <div class="col-md-7" id="content">




<div id="show_content">
<h1>Jenkins Pipeline: running external programs with sh or bat</h1>




  <div id="indexes">
    <ul>
      
         <li><a class="btn btn-mini btn-primary kw-button" href="/search/sh">sh</a></li>
      
         <li><a class="btn btn-mini btn-primary kw-button" href="/search/bat">bat</a></li>
      
    </ul>
  </div>



<div class="prev-next">
<h2>

  <span class="label label-lg label-success prev">
    <a href="jenkins-pipeline-hello-world.html" title="Jenkins Pipeline - Hello World"><span class="glyphicon glyphicon-chevron-left"></span> Prev</a>
  </span>



  <span class="label label-lg label-success next">
    <a href="jenkins-send-email-notifications.html" title="Jenkins Pipeline: Send e-mail notifications">Next <span class="glyphicon glyphicon-chevron-right"></span> </a>
  </span>
</h2>
</div>





<div role="main" id="main">

  <div id="top-poster"></div>

  <div id="abstract">
    
    <div id="abstract_text"> <p>
From within a Jenkins pipeline you can any external program. If your pipeline will run on Unix/Linux you need to use the <span class="inline_code">sh</span> command.
If your pipeline will run on MS Windows you'll need to use the <span class="inline_code">bat</span> command.
<p>
Naturally the commands you pass to these will also need to make sense on the specific operating system.
<p>
In this example first we use the internal <span class="inline_code">echo</span> command of Jenkins.
<p>
Then we call <span class="inline_code">sh</span> and run the <span class="inline_code">echo</span> of our Unix shell.
<p>
Then we execute the <span class="inline_code">hostname</span> command and finally the <span class="inline_code">uptime</span> command.
<p>
</div>
  </div>
  <div id="after-abstract"></div>
  
  <p>
<pre class="linenums">
pipeline {
    agent { label 'master' }
    stages {
        stage('build') {
            steps {
                echo "Hello World!"
                sh "echo Hello from the shell"
                sh "hostname"
                sh "uptime"
            }
        }
    }
}
</pre>
<p>
The result looks like this:
<p>
<pre class="linenums">
Started by user Gabor Szabo
Running in Durability level: MAX_SURVIVABILITY
[Pipeline] node
Running on Jenkins in /var/lib/jenkins/workspace/simple-pipeline
[Pipeline] {
[Pipeline] stage
[Pipeline] { (build)
[Pipeline] echo
Hello World!
[Pipeline] sh
[simple-pipeline] Running shell script
+ echo Hello from the shell
Hello from the shell
[Pipeline] sh
[simple-pipeline] Running shell script
+ hostname
s17
[Pipeline] sh
[simple-pipeline] Running shell script
+ uptime
 17:15:35 up 3 days,  1:59,  0 users,  load average: 0.00, 0.00, 0.00
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS
</pre>
<p>
<h2>MS Windows</h2>
<p>
A few examples in Windows:
<p>
Show the name of the computer (a bit like hostname on Unix):
<p>
<pre class="linenums">
bat 'wmic computersystem get name'
</pre>
<p>
Print out the content of the PATH environment variable as seen by Windows.
<p>
<pre class="linenums">
bat 'echo %PATH%'
</pre>
<p>
Of course we could have printed the PATH environment variable without invoking an external call:
<p>
<pre class="linenums">
echo env.PATH
</pre>
<p>
<h2>Print out all the environment variables seen by Windows.</h2>
<p>
<pre class="linenums">
echo bat(returnStdout: true, script: 'set')
</pre>
<p>
<h2>Get the disk size of a local disk</h2>
<p>
<pre class="linenums">
script {
    def disk_size = sh(script: "df / --output=avail | tail -1", returnStdout: true).trim() as Integer
    println("disk_size = ${disk_size}")
}
</pre>
<p>
<p>
Full examples:
<p>
<b>examples/jenkins/list_disk_size.Jenkinsfile</b><br><pre class="prettyprint linenums ">
pipeline {
    agent { label 'master' }
    stages {
        stage('build') {
            steps {
                script {
                    def disk_size = sh(script: "df / --output=avail | tail -1", returnStdout: true).trim() as Integer
                    println("disk_size = ${disk_size}")
                }
            }
        }
    }
}



</pre>
<p>
<h2>Get the disk size of a remote disk</h2>
<p>
<pre class="linenums">
script {
    def disk_size = sh(script: "ssh remote-server df / --output=avail | tail -1", returnStdout: true).trim() as Integer
    println("disk_size = ${disk_size}")
}
</pre>
<p>
<p>


  <div id="after-content"></div>
</div>




<div class="prev-next">
<h2>

  <span class="label label-lg label-success prev">
    <a href="jenkins-pipeline-hello-world.html" title="Jenkins Pipeline - Hello World"><span class="glyphicon glyphicon-chevron-left"></span> Prev</a>
  </span>



  <span class="label label-lg label-success next">
    <a href="jenkins-send-email-notifications.html" title="Jenkins Pipeline: Send e-mail notifications">Next <span class="glyphicon glyphicon-chevron-right"></span> </a>
  </span>
</h2>
</div>



<hr>
<div id="creators">
   

      
        <img src="img/szabgab.png" alt="Gabor Szabo" />
<!--
        Gábor who writes the articles of the Code Maven site offers <a href="/courses">courses</a> in in the subjects
that are discussed on this web site.
<p>
Gábor helps companies set up <b>test automation</b>, CI/CD
<b>Continuous Integration</b> and <b>Continuous Delivery</b> and other <b>DevOps</b> related
systems. Gabor can help your team improve the development speed and reduce the risk of bugs.
<p>
He is also the author of a number of <a href="https://leanpub.com/u/szabgab">eBooks</a>.
<p>
<a href="https://szabgab.com/contact.html">Contact Gabor</a> if you'd like to hire his services.
<p>
If you would like to <b>support</b> his freely available work, you can do it via
<a href="https://www.patreon.com/szabgab">Patreon</a>, <a href="https://github.com/sponsors/szabgab/">GitHub</a>,
or <a href="https://paypal.me/szabgab">PayPal</a>.


-->
        <div class="author_text">
           Written by<br>
           
             <a href="https://www.linkedin.com/in/szabgab/">Gabor Szabo</a>
           
        </div>
      

   
</div>




  <hr>
  <p>
  Published on 2018-08-20
  </p>








<h2>Comments</h2>


  In the comments, please wrap your code snippets within &lt;pre&gt; &lt;/pre&gt; tags and use spaces for indentation.

<div id="disqus_thread"></div>
<script>
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'code-maven'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>









<div>
  If you have any comments or questions, feel free to post them on the source of this page in GitHub. <a href="https://github.com/szabgab/code-maven.com/tree/main/sites/en/pages//jenkins-pipeline-running-external-programs.txt">Source on GitHub.</a>
  <a href="https://github.com/szabgab/code-maven.com/issues/new?title=&body=https://code-maven.com/jenkins-pipeline-running-external-programs">Comment on this post</a>
</div>

</div>

    </div>

<div id="modal"></div>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CB0RC0YM71"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CB0RC0YM71');
</script>





</body>
</html>



